
This is a fork of [gluonts-hierarchical-ICML-2021](https://github.com/rshyamsundar/gluonts-hierarchical-ICML-2021) 

## Setup
Download this code and rename the directory as 'gluonts-hierarchical-ICML-2021' then run following commands.
```
pip install --upgrade mxnet
cd gluonts-hierarchical-ICML-2021
pip install -e .
```

## Running

```
python experiments/run_experiment_with_best_hps.py --dataset dataset --method DeepVAR
```
where dataset is one of `{labour, traffic, tourism, wiki}` .

This will run the Our modified DeepVAR method with coherent loss function 5 times on the selected dataset with the best hyperparameters.

Results:
| RESULTS ON ALL LEVELS |  |  |  |  |  |  |

| --------------------- |  |  |  |  |  |  |

| Dataset |        Level | Our Model | Hier\-E2E | DeepVAR | DeepVAR\+ | Best of Competing Methods | 

| Labour | 1 | \* | 0\.0311\+/\-0\.0120 | 0\.0352\+/\-0\.0079 | 0\.0416\+/\-0\.0094 | 0\.0406\+/\-0\.0002 \(PERMBU\-MINT\) | 

|  | 2 | \* | 0\.0336\+/\-0\.0089 | 0\.0374\+/\-0\.0051 | 0\.0437\+/\-0\.0078 | 0\.0389\+/\-0\.0002 PERMBU\-MINT\) | 

|  | 3 | \* | 0\.0336\+/\-0\.0082 | 0\.0383\+/\-0\.0038 | 0\.0432\+/\-0\.0076 | 0\.0382\+/\-0\.0002 \(PERMBU\-MINT\) | 

|  | 4 | \* | 0\.0378\+/\-0\.0060 | 0\.0417\+/\-0\.0038 | 0\.0448\+/\-0\.0066 | 0\.0397\+/\-0\.0003 \(PERMBU\-MINT\) | 

| Traffic | 1 | 0\.0106\+/\-0\.0028\* | 0\.0184\+/\-0\.0091 | 0\.0225\+/\-0\.0109 | 0\.0250\+/\-0\.0082 | 0\.0087\(ARIMA\-ERM\) | 

|  | 2 | 0\.0144\+/\-0\.0002\* | 0\.0181\+/\-6\.0086 | 0\.0204\+/\-0\.0044 | 0\.0244\+/\-0\.0063 | 0\.0112\(ARIMA\-ERM\) | 

|  | 3 | 0\.0145\+/\-0\.0005\* | 0\.0223\+/\-0\.0072 | 0\.0190\+/\-0\.0031 | 0\.0259\+/\-0\.0054 | 0\.0255 \(ARIMA\-ERM\) | 

|  | 4 | 0\.0967\+/\-0\.0003\* | 0\.0914\+/\-0\.0024 | 0\.0982\+/\-0\.0012 | 0\.0982\+/\-0\.0017 | 0\.1410 \(ARIMA\-ERM\) | 

| Tourism | 1 | 0\.0622 \+/\- 0\.0131 | 0\.0402\+/\-0\.0040 | 0\.0519\+/\-0\.0057 | 0\.0508\+/\-0\.0085 | 0\.0472\+/\-0\.0012 \(PERMBU\-MINT\) | 

|  | 2 | 0\.0929 \+/\- 0\.0072 | 0\.0658\+/\-6\.0084 | 0\.0755\+/\-0\.0011 | 0\.0750\+/\-00066 | "0\.0605\+/\-0\.0006 \(PERMBU\-MINT\) | 

| 0\.0605\+/\-0\.0006 \(PERMBU\-MINT\)" | 

|  | 3 |  0\.1287 \+/\- 0\.0073 | 0\.1053\+/\-0\.0053 | 0\.1134\+/\-0\.0049 | 0\.1180\+/\-0\.0053 | 0\.0903\+/\-0\.0006 \(PERMBU\-MINT\) | 

|  | 4 | 0\.1525 \+/\- 0\.0057 | 0\.1223\+/\-0\.0039 | 0\.1294\+/\-0\.0060 | 0\. 1393\+/\-0\.0048 | 0\.1106\+/\-0\.0005 \(PERMBU\-MINT\) | 

| Wiki | 1 | 0\.0857 \+/\- 0\.0248 | 0\.0419\+/\-0\.0285 | 0\.0905\+/\-0\.0323 | 0\.0755\+/\-0\.0165 | 0\.1558 \(ETS\-ERM\) | 

|  | 2 | 0\.1329 \+/\- 0\.0164 | 0\.1045\+/\-0\.0151 |  0\.1418\+/\-0\.0249 | 0\.1289\+/\-010171 | "0\.1614\(ETS\-ERM\) | 

| 0\.1614 \(ETS\-ERM\)" | 

|  | 3 | 0\.2424 \+/\- 0\.0214 | 0\.2292\+/\-0\.0108 | 0\.2597\+/\-0\.0150 | 0\.2583\+/\-0\.0281 | 0\.2010\(ETS\-ERM\) | 

|  | 4 | 0\.2802 \+/\- 0\.0228 | 0\.2716\+/\-0\.0091 | 0\.2886\+/\-0\.0112 | 0\.3108\+/\-0\.0298 | 0\.2399 \(ETS\-ERM\) | 

|  | 5 | 0\.4030 \+/\- 0\.0208 | 0\.3720\+/\-0\.0150 | 0\.3664\+/\-0\.0068 | 0\.4460\+/\-0\.0271 | 0\.3507 \(ETS\-ERM\) | 

| \* Training or in Queue |  |  |  |  |  |  |

